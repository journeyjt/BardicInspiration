{{! Queue Section Component Template }}
<div class="section-header">
  <h3>
    <i class="fas fa-list-music"></i>
    Queue Management
  </h3>
  <div class="section-status">
    <div class="queue-stats">
      <span class="queue-count">{{queueCount}} {{#if (eq queueCount 1)}}track{{else}}tracks{{/if}} in queue</span>
      {{#if hasQueue}}
      {{#if isDJ}}
      <button type="button" class="control-btn danger-btn clear-queue-btn" title="Clear entire queue">
        <i class="fas fa-trash"></i>
        <span>Clear</span>
      </button>
      {{/if}}
      {{/if}}
    </div>
  </div>
</div>

{{#if isDJ}}
<!-- Video Input Controls (moved from PlayerControls) -->
<div class="control-group video-input-group">
  <div class="control-group-header">
    <span class="control-label">Add Videos to Queue</span>
  </div>
  <div class="input-controls">
    <div class="video-input-container">
      <input 
        type="text" 
        class="video-url-input youtube-url-input" 
        placeholder="Paste YouTube URL or video ID..."
        {{#unless isPlayerReady}}disabled{{/unless}}
      >
    </div>
    <div class="video-action-buttons">
      <button type="button" class="control-btn success-btn add-to-queue-btn" {{#unless isPlayerReady}}disabled{{/unless}}>
        <i class="fas fa-plus"></i>
        <span>Add to Queue</span>
      </button>
    </div>
  </div>
</div>
{{/if}}

{{! Playback Controls - shown when queue has videos but no currently playing video }}
{{#if (and hasQueue (not currentlyPlaying) isDJ)}}
<div class="queue-playback-controls">
  <div class="playback-controls-header">
    <span>Queue Playback</span>
  </div>
  <div class="playback-controls">
    <button type="button" class="control-btn primary-btn start-queue-btn" title="Start playing queue">
      <i class="fas fa-play"></i>
      <span>Start Queue</span>
    </button>
  </div>
</div>
{{/if}}

{{! Currently Playing Section with Integrated Playback Controls }}
{{#if currentlyPlaying}}
<div class="currently-playing-section">
  <div class="currently-playing-header">
    <div class="header-title">
      <i class="fas fa-play-circle"></i>
      <span>Currently Playing</span>
    </div>
    {{#if isDJ}}
    <div class="playback-controls">
      <button type="button" class="control-btn success-btn play-btn" title="Play">
        <i class="fas fa-play"></i>
      </button>
      <button type="button" class="control-btn pause-btn" title="Pause">
        <i class="fas fa-pause"></i>
      </button>
      <button type="button" class="control-btn skip-btn" title="Skip to next">
        <i class="fas fa-step-forward"></i>
      </button>
    </div>
    {{/if}}
  </div>
  <div class="currently-playing-item" data-queue-id="{{currentlyPlaying.id}}">
    <div class="queue-item-thumbnail">
      {{#if currentlyPlaying.thumbnailUrl}}
      <img src="{{currentlyPlaying.thumbnailUrl}}" alt="{{currentlyPlaying.title}}" loading="lazy">
      {{else}}
      <div class="thumbnail-placeholder">
        <i class="fab fa-youtube"></i>
      </div>
      {{/if}}
    </div>
    <div class="queue-item-info">
      <span class="queue-item-title">{{#if currentlyPlaying.title}}{{currentlyPlaying.title}}{{else}}{{currentlyPlaying.videoId}}{{/if}}</span>
      <div class="queue-item-meta">
        {{#if currentlyPlaying.authorName}}
        <span class="channel-name">{{currentlyPlaying.authorName}}</span>
        <span class="meta-separator">•</span>
        {{/if}}
        <span class="added-by">Added by {{currentlyPlaying.addedBy}}</span>
      </div>
    </div>
  </div>
</div>
{{/if}}

<div class="queue-list">
  <div class="queue-list-header">
    <span>Up Next</span>
  </div>
  {{#each upcomingQueue}}
  <div class="queue-item" data-index="{{actualIndex}}" data-queue-id="{{id}}">
    <div class="queue-position">
      <span class="position-number">{{add @index 1}}</span>
    </div>
    <div class="queue-item-thumbnail">
      {{#if thumbnailUrl}}
      <img src="{{thumbnailUrl}}" alt="{{title}}" loading="lazy">
      {{else}}
      <div class="thumbnail-placeholder">
        <i class="fab fa-youtube"></i>
      </div>
      {{/if}}
    </div>
    <div class="queue-item-info">
      <span class="queue-item-title">{{#if title}}{{title}}{{else}}{{videoId}}{{/if}}</span>
      <div class="queue-item-meta">
        {{#if authorName}}
        <span class="channel-name">{{authorName}}</span>
        <span class="meta-separator">•</span>
        {{/if}}
        <span class="added-by">Added by {{addedBy}}</span>
      </div>
    </div>
    {{#if ../isDJ}}
    <div class="queue-item-controls">
      <button type="button" class="skip-to-btn" data-index="{{actualIndex}}" title="Skip to this video" {{#if isCurrentItem}}disabled{{/if}}>
        <i class="fas fa-play"></i>
      </button>
      <button type="button" class="move-up-btn" data-index="{{actualIndex}}" title="Move up" {{#if @first}}disabled{{/if}}>
        <i class="fas fa-chevron-up"></i>
      </button>
      <button type="button" class="move-down-btn" data-index="{{actualIndex}}" title="Move down" {{#if @last}}disabled{{/if}}>
        <i class="fas fa-chevron-down"></i>
      </button>
      <button type="button" class="remove-queue-btn" data-queue-id="{{id}}" title="Remove">
        <i class="fas fa-times"></i>
      </button>
    </div>
    {{/if}}
  </div>
  {{else}}
  <div class="queue-empty">
    <i class="fas fa-music"></i>
    <p>Queue is empty</p>
    {{#if ../isDJ}}
    <p>Add videos using the controls above</p>
    {{/if}}
  </div>
  {{/each}}
</div>