<div class="youtube-dj-content">
  <header class="youtube-dj-header">
    <h2>
      <i class="fas fa-music"></i>
      YouTube DJ - Synced Player
    </h2>
    <div class="dj-status">
      {{#if isDJ}}
        <span class="status-dj">
          <i class="fas fa-microphone"></i> You are the DJ
        </span>
      {{else}}
        <span class="status-listener">
          <i class="fas fa-headphones"></i> Listening
        </span>
      {{/if}}
    </div>
  </header>

  <!-- Join Session Section (only when not joined) -->
  {{#unless hasJoinedSession}}
  <div class="join-session">
    <div class="join-info">
      <i class="fas fa-users"></i>
      <p>Ready to join the synchronized YouTube DJ session?</p>
      <p>This will create the video player and enable audio playback.</p>
    </div>
    <button type="button" class="join-session-btn">
      <i class="fas fa-play-circle"></i>
      Join Session
    </button>
  </div>
  {{/unless}}

  <!-- Session Members Section (only when joined) -->
  {{#if hasJoinedSession}}
  <div class="session-members">
    <!-- Row 1: DJ Control Buttons -->
    <div class="dj-controls-row">
      <div class="dj-controls">
        {{#if isDJ}}
        <button type="button" class="release-dj-btn">
          <i class="fas fa-crown"></i>
          Release DJ
        </button>
        {{#if canHandoffDJ}}
        <button type="button" class="handoff-dj-btn">
          <i class="fas fa-exchange-alt"></i>
          Hand Off
        </button>
        {{/if}}
        {{else}}
        <button type="button" class="claim-dj-btn">
          <i class="fas fa-microphone"></i>
          Become DJ
        </button>
        <button type="button" class="request-dj-btn">
          <i class="fas fa-hand-paper"></i>
          Request DJ
        </button>
        {{/if}}
        {{#if isGM}}
        <button type="button" class="gm-override-btn">
          <i class="fas fa-gavel"></i>
          GM Override
        </button>
        {{/if}}
      </div>
    </div>

    <!-- Row 2: Session Members Title -->
    <div class="members-title-row">
      <h3>
        <i class="fas fa-users"></i>
        Session Members
      </h3>
    </div>
    <div class="members-list">
      {{#each sessionMembers}}
      <div class="member-item {{#if isDJ}}member-dj{{else}}member-listener{{/if}}">
        <i class="fas {{#if isDJ}}fa-microphone{{else}}fa-headphones{{/if}}"></i>
        <span class="member-name">{{name}}</span>
        {{#if isDJ}}<span class="member-role">DJ</span>{{/if}}
      </div>
      {{else}}
      <div class="member-item">
        <i class="fas fa-user"></i>
        <span class="member-name">You</span>
        {{#if ../isDJ}}<span class="member-role">DJ</span>{{/if}}
      </div>
      {{/each}}
    </div>
  </div>
  
  <!-- MVP-U6: DJ Requests Section (for current DJ only) -->
  {{#if isDJ}}
  {{#if hasDJRequests}}
  <div class="dj-requests">
    <div class="requests-header">
      <h3>
        <i class="fas fa-hand-paper"></i>
        DJ Requests ({{djRequests.length}})
      </h3>
    </div>
    <div class="dj-requests-list">
      {{#each djRequests}}
      <div class="dj-request-item">
        <span class="requester-name">{{userName}}</span>
        <div class="request-actions">
          <button class="approve-dj-request-btn" data-requester-id="{{userId}}">
            <i class="fas fa-check"></i> Approve
          </button>
          <button class="deny-dj-request-btn" data-requester-id="{{userId}}">
            <i class="fas fa-times"></i> Deny
          </button>
        </div>
      </div>
      {{/each}}
    </div>
  </div>
  {{/if}}
  {{/if}}

  <!-- YouTube Player Container -->
  {{#if hasJoinedSession}}
  <div class="player-section">
    <div class="player-info">
      <h3>{{currentVideoTitle}}</h3>
      <div class="player-status-container">
        Status: <span class="player-status">{{playerState}}</span>
      </div>
    </div>
    
    <div id="youtube-player-container">
      <!-- YouTube player will be inserted here -->
    </div>
  </div>
  {{/if}}

  <!-- Transport Controls & Queue Controls -->
  {{#if hasJoinedSession}}
  <div class="player-controls-section">
    <div class="controls-header">
      <h3>
        <i class="fas fa-music"></i>
        Player Controls
      </h3>
    </div>
    
    <!-- Transport Controls Container - Always Present -->
    <div class="transport-controls">
      <div class="transport-buttons">
        {{#if isDJ}}
          <button 
            type="button" 
            class="play-btn transport-btn"
            {{#unless isPlayerReady}}disabled{{/unless}}
          >
            <i class="fas fa-play"></i>
            Play
          </button>
          <button 
            type="button" 
            class="pause-btn transport-btn"
          >
            <i class="fas fa-pause"></i>
            Pause
          </button>
          <button 
            type="button" 
            class="next-btn transport-btn"
            {{#unless hasQueue}}disabled{{/unless}}
          >
            <i class="fas fa-step-forward"></i>
            Next
          </button>
        {{else}}
          <div class="listener-info">
            <i class="fas fa-info-circle"></i>
            <p>Playback is controlled by the DJ</p>
          </div>
        {{/if}}
      </div>
      
      <!-- MVP-U6: Mute Control -->
      <div class="mute-control">
        <button type="button" class="mute-player-btn" title="{{#if isPlayerMuted}}Unmute Player{{else}}Mute Player{{/if}}">
          <i class="fas {{#if isPlayerMuted}}fa-volume-mute{{else}}fa-volume-up{{/if}}"></i>
        </button>
      </div>
    </div>
    
    <!-- Seek Bar (DJ only) -->
    {{#if isDJ}}
    <div class="seek-section">
      <div class="seek-container">
        <span class="current-time">0:00</span>
        <input 
          type="range" 
          class="seek-bar" 
          min="0" 
          max="100" 
          value="0"
          {{#unless isPlayerReady}}disabled{{/unless}}
        >
        <span class="total-time">0:00</span>
      </div>
    </div>
    
    {{/if}}
    
    <!-- URL Input Section - Always Present -->
    <div class="url-input-section {{#unless isDJ}}non-dj-disabled{{/unless}}">
      <div class="input-group">
        <input 
          type="text" 
          class="youtube-url-input" 
          placeholder="{{#if isDJ}}Paste YouTube URL or video ID...{{else}}Only the DJ can add videos{{/if}}"
          {{#unless isDJ}}disabled{{/unless}}
          {{#unless isPlayerReady}}disabled{{/unless}}
        >
        <button 
          type="button" 
          class="add-to-queue-btn"
          {{#unless isDJ}}disabled{{/unless}}
          {{#unless isPlayerReady}}disabled{{/unless}}
        >
          <i class="fas fa-plus"></i>
          Add to Queue
        </button>
        <button 
          type="button" 
          class="load-video-btn"
          {{#unless isDJ}}disabled{{/unless}}
          {{#unless isPlayerReady}}disabled{{/unless}}
        >
          <i class="fas fa-play"></i>
          Play Now
        </button>
      </div>
    </div>
  </div>

  <!-- MVP-U4: Queue Section -->
  <div class="queue-section">
    <div class="queue-header">
      <h3>
        <i class="fas fa-list"></i>
        Queue ({{queue.length}} videos)
      </h3>
    </div>
    
    <div class="queue-list">
      {{#each queue}}
      <div class="queue-item" data-index="{{@index}}" data-queue-id="{{id}}">
        <div class="queue-item-info">
          <span class="queue-item-title">{{#if title}}{{title}}{{else}}{{videoId}}{{/if}}</span>
          <span class="queue-item-meta">Added by {{addedBy}}</span>
        </div>
        {{#if ../isDJ}}
        <div class="queue-item-controls">
          <button type="button" class="move-up-btn" data-index="{{@index}}" title="Move up" {{#if @first}}disabled{{/if}}>
            <i class="fas fa-chevron-up"></i>
          </button>
          <button type="button" class="move-down-btn" data-index="{{@index}}" title="Move down" {{#if @last}}disabled{{/if}}>
            <i class="fas fa-chevron-down"></i>
          </button>
          <button type="button" class="remove-queue-btn" data-queue-id="{{id}}" title="Remove">
            <i class="fas fa-times"></i>
          </button>
        </div>
        {{/if}}
      </div>
      {{else}}
      <div class="queue-empty">
        <i class="fas fa-music"></i>
        <p>No videos in queue</p>
        {{#if ../isDJ}}
        <p>Add videos using the controls above</p>
        {{/if}}
      </div>
      {{/each}}
    </div>
  </div>
  {{/if}}



  {{/if}}

  <!-- Actions -->
  <div class="youtube-dj-actions">
    {{#if isPlayerReady}}
    <button type="button" class="recreate-player-btn">
      <i class="fas fa-redo"></i>
      Recreate Player
    </button>
    {{else}}
    <button type="button" class="recreate-player-btn">
      <i class="fas fa-sync-alt"></i>
      Refresh
    </button>
    {{/if}}
    <button type="button" class="close-btn">
      <i class="fas fa-times"></i>
      Close
    </button>
  </div>
</div>